<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <form (ngSubmit)="onSubmit()" #medicoForm="ngForm">
          <div [hidden]="medicoForm.submitted">
            <ngb-tabset type="pills">
              <ngb-tab title="Informações Pessoais">
                <ng-template ngbTabContent>
                  <div id="tab_1" style="margin-top: 10px;" class="container col-sm-12 col-md-12">
                    <div class="row"></div>

                    <div class="row rowcadastro">
                      <div class="col-xs-12 col-md-6">
                        <div class="form-group">
                          <label class="control-label" for="nomeCompleto">Nome Completo(*)</label>
                          <input type="text" id="nomeCompleto" placeholder="Nome Completo" name="nomeCompleto"
                            class="form-control" required minlength="4" [(ngModel)]="medico.nomeCompleto"
                            #nomeCompleto="ngModel">
                          <div *ngIf="nomeCompleto.invalid && (nomeCompleto.dirty || nomeCompleto.touched)"
                            class="alert alert-danger">
                            <div *ngIf="nomeCompleto.errors.required"> Nome Obrigatório. </div>
                            <div *ngIf="nomeCompleto.errors.minlength"> Nome deve ter ao menos 4 caracteres. </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="cpf">CPF</label>
                          <input type="text" id="cpf" appValidapf mask="000.000.000-00" placeholder="CPF" name="cpf"
                            class="form-control" [(ngModel)]="medico.cpf" #cpf="ngModel">
                          <div *ngIf="cpf.invalid && cpf.errors?.validaCpf && (cpf.dirty || cpf.touched)"
                            class="alert alert-danger">
                            <div *ngIf="cpf.errors?.validaCpf"> CPF inválido. </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="rg">RG</label>
                          <input type="text" id="rg" placeholder="RG" name="rg" class="form-control"
                            [(ngModel)]="medico.rg" #rg="ngModel">
                        </div>
                      </div>
                    </div>

                    <div class="row rowcadastro">

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="dataNascimento">Data de Nascimento</label>
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                            </div>
                            <input type="text" mask="00/00/0000" id="dataNascimento" name="dataNascimento"
                              placeholder="dd/mm/yyyy" class="form-control" [(ngModel)]="data" #dataNascimento="ngModel"
                              (blur)="formataData($event)">
                          </div>
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="celular">Celular(*)</label>
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text"><i class="fa fa-mobile-phone"></i></span>
                            </div>
                            <input type="text" mask="(00) 0 0000-0000" id="celular" name="celular" placeholder="Celular"
                              class="form-control" required [(ngModel)]="medico.celular" #celular="ngModel"
                              pattern="^[0-9]{11}$">
                          </div>
                          <div *ngIf="celular.invalid && (celular.dirty || celular.touched)" class="alert alert-danger">
                            <div *ngIf="celular.errors.required"> Celular Obrigatório. </div>
                            <div *ngIf="celular.errors.pattern"> Celular Inválido.</div>
                          </div>
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="crm">CRM</label>
                          <div class="input-group mb-3">
                            <input type="text" id="crm" placeholder="CRM" name="crm" class="form-control"
                              [(ngModel)]="medico.crm" #crm="ngModel">
                          </div>
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="email">E-mail(*)</label>
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text">@</span>
                            </div>
                            <input type="email" id="email" placeholder="medico@email.com" name="email"
                              class="form-control" email required [(ngModel)]="medico.email" #emailInput="ngModel">
                          </div>
                          <div
                            *ngIf="(emailInput.invalid || medicoForm.submitted) && (emailInput.dirty || emailInput.touched)"
                            class="alert alert-danger">
                            <div *ngIf="emailInput.errors.required"> E-mail Obrigatório. </div>
                            <div *ngIf="emailInput.errors.email"> E-mail inválido. </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row rowcadastro">

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="especialidadeSelecionado">Especialidade(*)</label>
                          <input id="especialidadeSelecionada" name="especialidadeSelecionada" type="text"
                            (selectItem)="selecionaEspecialidade($event)" required
                            placeholder="Digite a especialidade..." [ngbTypeahead]="buscaEspecialidade"
                            class="form-control" #especialidade="ngModel" [(ngModel)]="especialidadeSelecionada" />
                          <div
                            *ngIf="(falhaNaBusca || especialidade.invalid) && (especialidade.dirty || especialidade.touched)"
                            class="alert alert-danger">
                            <div *ngIf="falhaNaBusca">Não foi possível encontrar uma especialidade com esta descrição.
                            </div>
                            <div *ngIf="especialidade.errors?.required">Especialidade obrigatória.</div>
                          </div>
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="cep">CEP</label>
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text"><img src="../../../assets/images/icon/logo-correio.png"
                                  width="25" height="22"> </span>
                            </div>
                            <input type="text" id="cep" mask="00.000-000" placeholder="CEP" name="cep"
                              class="form-control" (blur)="buscaCep()" [(ngModel)]="medico.cep" #cep="ngModel">
                          </div>
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="endereco">Endereço</label>
                          <input type="text" id="endereco" placeholder="Endereço" name="endereco" class="form-control"
                            [(ngModel)]="medico.endereco" #endereco="ngModel">
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="numero">Número</label>
                          <input type="text" id="numero" placeholder="Número" name="numero" class="form-control"
                            [(ngModel)]="medico.numero" #numero>
                        </div>
                      </div>
                    </div>

                    <div class="row rowcadastro">

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="complemento">Complemento</label>
                          <input type="text" id="complemento" placeholder="Complemento" name="complemento"
                            class="form-control" [(ngModel)]="medico.complemento" #complemento="ngModel">
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="bairro">Bairro</label>
                          <input type="text" id="bairro" placeholder="Bairro" name="bairro" class="form-control"
                            [(ngModel)]="medico.bairro" #bairro="ngModel">
                        </div>
                      </div>

                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="cidade">Cidade</label>
                          <input type="text" id="cidade" placeholder="Cidade" name="cidade" class="form-control"
                            [(ngModel)]="medico.cidade" #cidade="ngModel">
                        </div>
                      </div>
                      <div class="col-xs-6 col-md-3">
                        <div class="form-group">
                          <label class="control-label" for="uf">Estado</label>
                          <select class="form-control" [(ngModel)]="medico.uf" #uf="ngModel" id="uf" name="uf">
                            <option *ngFor="let codigo of estados | enumToArray">
                              {{codigo}}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>

                    <div class="row rowcadastro">
                      <div class="col-xs-4 col-md-2">
                        <label class="form-check-inline" for="ativo">Ativo</label>
                        <input class="form-check-inline" [(ngModel)]="medico.ativo" checked name="ativo" id="ativo"
                          value="checked" type="checkbox">
                      </div>
                    </div>
                  </div>
                </ng-template>
              </ngb-tab>
              <ngb-tab title="Convênio">
                <ng-template ngbTabContent>
                  <div id="tab_3" style="margin-top: 10px;" class="container col-sm-12 col-md-12">
                    <div class="card-header">
                      <h3>Arraste o convênio para associar o convênio ao médico</h3>
                    </div>
                    <div class="d-flex">
                      <div class="container">
                        <span class="group-handle">Convênios</span>
                        <div class='dragndrop' id="convenios" dragula="CONVENIO" [(dragulaModel)]="convenios">
                          <div *ngFor="let conv of convenios">{{conv.nomeConvenio}}</div>
                        </div>
                      </div>
                      <div class="container">
                        <span class="group-handle">Convênios Médico</span>
                        <div class='dragndrop' id="conveniosMedico" dragula="CONVENIO"
                          [(dragulaModel)]="medico.convenios">
                          <div *ngFor="let conv of medico.convenios">{{conv.nomeConvenio}}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
              </ngb-tab>
              <ngb-tab id="tabConfiguracaoAgenda" title="Configuração Agenda">
                <ng-template ngbTabContent>
                  <div id="tab_5" style="margin-top: 10px;" class="container col-sm-12 col-md-12">
                    <div class="row"></div>
                    <div class="table-responsive">
                      <table class="table">
                        <thead>
                          <tr>
                            <th></th>
                            <th>Dia</th>
                            <th class="text-center">Horário 1</th>
                            <th class="text-center">Horário 2</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td></td>
                            <td>Todos</td>
                            <td>
                              <div class="row">
                                <div class="col-xs-3 col-md-4">
                                  <div class="form-group">
                                    <input type="text" id="primeiroHorarioInicialTodos"
                                      name="primeiroHorarioInicialTodos" class="form-control"
                                      [(ngModel)]="medico.complemento" #primeiroHorarioInicialTodos="ngModel">
                                  </div>
                                </div>

                                <div class="col-md-2 text-center">até</div>

                                <div class="col-xs-3 col-md-4">
                                  <div class="form-group">
                                    <input type="text" id="primeiroHorarioFinalTodos" name="primeiroHorarioFinalTodos"
                                      class="form-control" [(ngModel)]="medico.complemento"
                                      #primeiroHorarioFinalTodos="ngModel">
                                  </div>
                                </div>
                              </div>
                            </td>
                            <td>
                              <div class="row">
                                <div class="col-xs-3 col-md-4">
                                  <div class="form-group">
                                    <input type="text" id="segundoHorarioInicialTodos" name="segundoHorarioInicialTodos"
                                      class="form-control" [(ngModel)]="medico.complemento"
                                      #segundoHorarioInicialTodos="ngModel">
                                  </div>
                                </div>
                                <div class="col-md-2 text-center">até</div>
                                <div class="col-xs-3 col-md-4">
                                  <div class="form-group">

                                    <input type="text" id="segundoHorarioFinalTodos" name="segundoHorarioFinalTodos"
                                      class="form-control" [(ngModel)]="medico.complemento"
                                      #segundoHorarioFinalTodos="ngModel">
                                  </div>
                                </div>
                              </div>
                            </td>
                            <td>
                          </tr>
                          <tr>
                            
                            <td><input checked="checked" [(ngModel)]="medico.configuracaoAgenda.segunda" id="segunda" name="segunda" type="checkbox"></td>
                            <td>Segunda</td>
                            <td>
                              <div class="row">
                                <div class="col-xs-3 col-md-4">
                                  <div class="form-group">
                                    <input type="text" id="primeiroHorarioInicialSegunda"
                                      name="primeiroHorarioInicialSegunda" class="form-control"
                                      [(ngModel)]="medico.configuracaoAgenda.primeiroHorarioInicialSegunda"
                                      #primeiroHorarioInicialSegunda="ngModel">
                                  </div>
                                </div>
                                <div class="col-md-2 text-center">até</div>
                                <div class="col-xs-3 col-md-4">
                                  <div class="form-group">
                                    <input type="text" id="primeiroHorarioFinalSegunda"
                                      name="primeiroHorarioFinalSegunda" class="form-control"
                                      [(ngModel)]="medico.configuracaoAgenda.primeiroHorarioFinalSegunda"
                                      #primeiroHorarioFinalSegunda="ngModel">
                                  </div>
                                </div>
                              </div>
                            </td>
                            <td>
                                <div class="row">
                                    <div class="col-xs-3 col-md-4">
                                      <div class="form-group">
                                        <input type="text" id="segundoHorarioInicialSegunda"
                                          name="segundoHorarioInicialSegunda" class="form-control"
                                          [(ngModel)]="medico.configuracaoAgenda.segundoHorarioInicialSegunda"
                                           #segundoHorarioInicialSegunda="ngModel">
                                      </div>
                                    </div>
                                    <div class="col-md-2 text-center">até</div>
                                    <div class="col-xs-3 col-md-4">
                                      <div class="form-group">
                                        <input type="text" id="segundoHorarioFinalSegunda"
                                          name="segundoHorarioFinalSegunda" class="form-control"
                                          [(ngModel)]="medico.configuracaoAgenda.segundoHorarioFinalSegunda"
                                          #segundoHorarioFinalSegunda="ngModel">
                                      </div>
                                    </div>
                                  </div>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </ng-template>
              </ngb-tab>
              <ngb-tab id="tabEspecialidadeObstetricia" title="Gestantes" *ngIf="ExibeAbaEspecialidade('obstetrícia')">
                <ng-template ngbTabContent>
                  <div id="tab_4" style="margin-top: 10px;" class="container col-sm-12 col-md-12">
                    <div class="row"></div>
                    <div class="table table-responsive smart-table">
                      <ng2-smart-table [(settings)]="settings" [(source)]="source" class=""
                        (edit)="editarPaciente($event)">
                      </ng2-smart-table>
                    </div>
                  </div>
                </ng-template>
              </ngb-tab>
            </ngb-tabset>
          </div>
          <div class="panel-footer rowcadastro">
            <div class="form-group">
              <div class="col-xs-8 col-md-6">
                <button style="width:40%" class="btn btn-rounded btn-success" [disabled]="!medicoForm.form.valid"
                  type="submit">Salvar</button>
                <a href="javascript:history.back()" style="width:40%" class="btn btn-rounded btn-danger">Cancelar</a>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>